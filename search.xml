<?xml version="1.0" encoding="utf-8"?>
<search> 
  
  
    
    <entry>
      <title>一个可以发送色图的QQ机器人</title>
      <link href="/2022/02/17/oicq-setu-boot/"/>
      <url>/2022/02/17/oicq-setu-boot/</url>
      
        <content type="html"><![CDATA[<blockquote><p>创建一个可以自动发送色图的QQ机器人，指定关键词或者定时发送。</p></blockquote><h3 id="框架"><a href="#框架" class="headerlink" title="框架"></a>框架</h3><ul><li><a href="https://github.com/takayama-lily/oicq">OICQ</a>,QQ(安卓)协议基于Node.js的实现。</li><li>API，<a href="https://api.lolicon.app/#/setu">luolicon</a></li></ul><span id="more"></span><hr><h3 id="环境安装"><a href="#环境安装" class="headerlink" title="环境安装"></a>环境安装</h3><h4 id="安装VSCODE"><a href="#安装VSCODE" class="headerlink" title="安装VSCODE"></a>安装VSCODE</h4><p><a href="https://code.visualstudio.com/">官方下载</a></p><h4 id="安装node"><a href="#安装node" class="headerlink" title="安装node"></a>安装node</h4><p><a href="https://nodejs.org/zh-cn/">官方下载</a></p><hr><h3 id="创建项目"><a href="#创建项目" class="headerlink" title="创建项目"></a>创建项目</h3><p>创建一个文件夹，比如在桌面新建一个setu-boot文件夹<br>打开文件夹，右键-&gt;通过vscode打开</p><h3 id="安装依赖"><a href="#安装依赖" class="headerlink" title="安装依赖"></a>安装依赖</h3><p>在vscode中的终端窗口输入<code>node -v</code>来检查node.js是否正常</p><h5 id="需要的安装"><a href="#需要的安装" class="headerlink" title="需要的安装"></a>需要的安装</h5><pre class="language-shell" data-language="shell"><code class="language-shell"># 首先安装yarnnpm install -g yarn# 安装OICQyarn add oicq# 安装node-fetchyarn add node-fetch# 安装定时模块yarn add node-schedule</code></pre><p>完成后修改package.json,添加<code>&quot;type&quot;: &quot;module&quot;</code></p><h5 id="新建index-js"><a href="#新建index-js" class="headerlink" title="新建index.js"></a>新建index.js</h5><pre class="language-javascript" data-language="javascript"><code class="language-javascript"><span class="token keyword">import</span> createClient <span class="token keyword">from</span> <span class="token string">'oicq'</span><span class="token keyword">const</span> _qq_account <span class="token operator">=</span> <span class="token punctuation">&#123;</span>    <span class="token literal-property property">platform</span><span class="token operator">:</span> <span class="token number">5</span><span class="token punctuation">,</span>    <span class="token literal-property property">uin</span><span class="token operator">:</span> 你的<span class="token constant">QQ</span>号<span class="token punctuation">,</span>    <span class="token literal-property property">password</span><span class="token operator">:</span> <span class="token string">'密码'</span><span class="token punctuation">,</span>    <span class="token literal-property property">logLevel</span><span class="token operator">:</span> <span class="token string">"info"</span><span class="token punctuation">,</span>  <span class="token comment">//trace,debug,info,warn,error,mark</span><span class="token punctuation">&#125;</span><span class="token punctuation">;</span><span class="token keyword">const</span> bot <span class="token operator">=</span> <span class="token function">createClient</span><span class="token punctuation">(</span>_qq_account<span class="token punctuation">.</span>uin<span class="token punctuation">,</span> <span class="token punctuation">&#123;</span> <span class="token literal-property property">platform</span><span class="token operator">:</span> _qq_account<span class="token punctuation">.</span>platform<span class="token punctuation">,</span> <span class="token literal-property property">log_level</span><span class="token operator">:</span> _qq_account<span class="token punctuation">.</span>logLevel <span class="token punctuation">&#125;</span><span class="token punctuation">)</span>bot<span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">"system.login.qrcode"</span><span class="token punctuation">,</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">e</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span><span class="token keyword">this</span><span class="token punctuation">.</span>logger<span class="token punctuation">.</span><span class="token function">mark</span><span class="token punctuation">(</span><span class="token string">"扫码后按Enter完成登录"</span><span class="token punctuation">)</span>process<span class="token punctuation">.</span>stdin<span class="token punctuation">.</span><span class="token function">once</span><span class="token punctuation">(</span><span class="token string">"data"</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span><span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">login</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">login</span><span class="token punctuation">(</span><span class="token punctuation">)</span>exports<span class="token punctuation">.</span>bot <span class="token operator">=</span> bot<span class="token comment">// template plugins</span><span class="token function">require</span><span class="token punctuation">(</span><span class="token string">"./plugin-setu"</span><span class="token punctuation">)</span> <span class="token comment">//hello world</span>process<span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">"unhandledRejection"</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">reason<span class="token punctuation">,</span> promise</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span>console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'Unhandled Rejection at:'</span><span class="token punctuation">,</span> promise<span class="token punctuation">,</span> <span class="token string">'reason:'</span><span class="token punctuation">,</span> reason<span class="token punctuation">)</span><span class="token punctuation">&#125;</span><span class="token punctuation">)</span></code></pre><h5 id="新建plugin-setu-js"><a href="#新建plugin-setu-js" class="headerlink" title="新建plugin-setu.js"></a>新建plugin-setu.js</h5><pre class="language-javascript" data-language="javascript"><code class="language-javascript"><span class="token keyword">import</span> fetch <span class="token keyword">from</span> <span class="token string">'node-fetch'</span><span class="token punctuation">;</span><span class="token keyword">import</span> segment <span class="token keyword">from</span> <span class="token string">'oicq'</span><span class="token keyword">import</span> bot <span class="token keyword">from</span> <span class="token string">'./index'</span><span class="token keyword">import</span> schedule <span class="token keyword">from</span> <span class="token string">'node-schedule'</span>bot<span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">"message.group"</span><span class="token punctuation">,</span> <span class="token parameter">msg</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span><span class="token comment">// console.log(msg)</span><span class="token keyword">if</span> <span class="token punctuation">(</span>msg<span class="token punctuation">.</span>raw_message<span class="token punctuation">.</span><span class="token function">indexOf</span><span class="token punctuation">(</span><span class="token string">'色图'</span><span class="token punctuation">)</span> <span class="token operator">></span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">let</span> res <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token function">fetch</span><span class="token punctuation">(</span><span class="token string">'https://api.lolicon.app/setu/v2'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">let</span> data <span class="token operator">=</span> <span class="token keyword">await</span> res<span class="token punctuation">.</span><span class="token function">json</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">let</span> setu <span class="token operator">=</span> <span class="token punctuation">[</span>      segment<span class="token punctuation">.</span><span class="token function">image</span><span class="token punctuation">(</span>data<span class="token punctuation">.</span>data<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>urls<span class="token punctuation">.</span>original<span class="token punctuation">)</span>    <span class="token punctuation">]</span>    msg<span class="token punctuation">.</span><span class="token function">reply</span><span class="token punctuation">(</span>setu<span class="token punctuation">,</span> <span class="token boolean">true</span><span class="token punctuation">)</span>    <span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token parameter">res</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span>      <span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span>        msg<span class="token punctuation">.</span>group<span class="token punctuation">.</span><span class="token function">recallMsg</span><span class="token punctuation">(</span>res<span class="token punctuation">.</span>message_id<span class="token punctuation">)</span>      <span class="token punctuation">&#125;</span><span class="token punctuation">,</span><span class="token number">20000</span><span class="token punctuation">)</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token comment">//20S后撤回</span>  <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span></code></pre><h5 id="运行"><a href="#运行" class="headerlink" title="运行"></a>运行</h5><pre class="language-shell" data-language="shell"><code class="language-shell">node index.js# 或者使用pm2管理npm install -g pm2pm2 start index.js --name setu</code></pre>]]></content>
      
      
      <categories>
          
          <category> 工具 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> QQ机器人 </tag>
            
            <tag> Node.js </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>微软office365 E5开发者账户调用API续订</title>
      <link href="/2022/02/17/E5-renew/"/>
      <url>/2022/02/17/E5-renew/</url>
      
        <content type="html"><![CDATA[<blockquote><p>微软开发者账户提供25个账号，每个账号可享有5T的云盘空间。<br>注册很简单，但是续订也许对于小白并不简单，运气也有一定比重，虽然也有极少的非酋会续不上。</p></blockquote><p>Api续订的方式有很多</p><span id="more"></span><ul><li>调用OneDrive的有oneIndex，Cloudreve，onemanger等，平时多使用这些网盘工具，这个工具的成功几率玄学，反正有在用，当成自己的不限速网盘也是不错的。</li><li>Windows电脑上运行软件，<code>MS365 E5 Renew Plus</code>，传送门<a href="https://e5renew.com/">E5 Renew Plus 官方网站</a>，很高的几率续订成功，只要你平时上班时后台运行即可，有很好的文档和健全的生态，据官方介绍，没有续费不成功的案例，可以说是非常niubility了。</li><li>网页端，如果你是学生党，没发长时间开着电脑，可以尝试自建服务器或者使用别人的服务器，<code>Microsoft 365 E5 Renew X</code>你可以自己用或者分享给大家一起用，传送门<a href="https://blog.csdn.net/qq_33212020/article/details/119747634">E5 调用API续订服务：Microsoft 365 E5 Renew X_SundayRX的博客-CSDN博客_e5续订</a>, 如果有群晖等NAS类终端，或者可以docker的软路由等小主机，可以使用docker。</li><li>github, AutoApi, 这个去github上搜就行了，有很多，安装教程走一遍基本上ok，也可以fork我的<a href="https://github.com/oyzbmmmm/365RefreshApi">oyzbmmmm/365RefreshApi (github.com)</a></li><li>电报机器人，较为简单<pre class="language-html" data-language="html"><code class="language-html">@E5Sub_bot@CRE5bot@EUe5bot@E5_subbot@kre5_bot@E5subot@raindev_bot@rldsBot@NawE5SubBot@officeE5_bot (@kingyii: 唯一一个使用 kubernetes 运行的 e5 机器人)@SubE5_Bot@subfore5_bot@My_e5_bot@One365E5_bot更多 bot 加 tg 群组 https://t.me/e5subbottelegram bot 源码 https://github.com/iyear/E5SubBot使用的时候给 bot 发送 然后复制那个 secret 密码，登录你需要续订的 e5 账号，获取 ID根据他给的格式填入信息并发送。然后再去跳转连接复制那个 localhost… 的网址 + 空格 + 随便一个别名（用于管理）并发送即可绑定成功</code></pre>本文不是原创，记录下，防止资源丢失。</li></ul><p>有问题，可以提出。</p>]]></content>
      
      
      <categories>
          
          <category> 工具 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> tool </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>这是一个文章模板</title>
      <link href="/2020/03/05/hello-world/"/>
      <url>/2020/03/05/hello-world/</url>
      
        <content type="html"><![CDATA[<blockquote><p>这是引用</p></blockquote><hr><p>这里是摘要</p><span id="more"></span><p>这里是更多内容</p><p>额外的头部字段</p><ul><li>author: 设置作者则会显示</li><li>email: 自动根据邮箱获取 Gravatar 头像</li><li>toc: 是否显示目录（文章 post 默认显示，页面 post 默认不显示）</li><li>readmore: 将会首页卡片摘要末尾强制显示一个 阅读更多 按钮</li><li>hideTime: 强制隐藏时间显示</li></ul><hr><pre class="language-shell" data-language="shell"><code class="language-shell">title: xxxauthor: 云游君email: me@yunyoujun.cnreadmore: truehideTime: true</code></pre><hr><p>description: 描述（只出现在预览卡片上，不出现在正文中）（默认使用 400 字重以表强调，略细于加粗字体）<br>excerpt: 摘要（不需要在 Front-matter 中设置，通过 <!-- more --> 截断实现，预览卡片与正文中均出现）</p><hr><pre class="language-none"><code class="language-none">title: xxxdescription: xxxxxxx</code></pre><hr>]]></content>
      
      
      <categories>
          
          <category> 建站 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Hexo </tag>
            
        </tags>
      
    </entry>
    
    
  
  
</search>
